<?php
/**
 * I belong to Defination
 */

class  FieldCategoryDefine extends FieldDefine {
    
    public function __construct() {
        parent::__construct();
    }
    
  
    /**
    * Will through exception is not unique name.
    *
    * @param string $name Unique name of the field
    * @param integer $_formTypeId its parent form type
    * @param string $datas text, date, number, boolean
    *
    *  @return integer the field id
    */
    function create($name, $_formTypeId, $datas, $type="number")
    {
       //call the parent create
       $fieldId = parent::create($name, $_formTypeId, "bool", true);
       
       //populate the possible options in the dropdown
       foreach($datas as $data)
       {
            $this->db->insert("field_text", array(
                "value" => $data["value"],
                "label" => (isset($data["label"])?$data["label"] : ''),
                "_fieldId" => $fieldId
            ));
       }
       
       return $fieldId;
    }
    
    
    
    /**
    * @param string $name string or number
    *
    * @return boolean
    */
    function delete($name)
    {
        //get the id if name is inputed
        $id;
        if(is_numeric($name)){
            $id=$name;
        }
        else{
            $data = $this->db->select("select id from field where name = :name", array("name" => $name));
            if(isset($data[0]["id"]))
            {
                $id = $data[0]["id"];
            }
            else
            {
                return false;
            }
        }
        
        //delte the values
        $this->db->delete("field_text", "_fieldId = " . $id);
        
        //delete the field
        return parent::delete($id);
    
    }


}
